{% extends "base.html" %}

{% block contenido %}
<div class="p-6">

  <h1 class="text-2xl font-semibold mb-4 text-gray-700">Buscar Paciente</h1>

  <!-- Buscador -->
  <div class="relative max-w-lg">
    <input id="buscarInput" 
           type="text"
           placeholder="Escriba nombre o c√©dula del paciente..."
           class="border rounded-lg w-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" />
    <a href="/formulario" class="bg-neutral-primary-soft block  border border-default rounded-base shadow-xs transition hover:bg-gray-200"></a>
    <!-- Resultados din√°micos -->
    <div id="resultados" 
         class="absolute bg-white border rounded-lg mt-1 w-full shadow hidden z-10">
    </div>
    
  </div>

  <!-- Bot√≥n de prueba manual -->
  <div class="mt-6">
    <a href="/pacientes/agregar">agregar pacientes</a>
    <button onclick="abrirModalPaciente(1, 'Juan P√©rez', 'CC', '123456789', 'Bogot√°')" 
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
      üîç Probar Modales
    </button>
  </div>

</div>

<!-- ===================== MODAL 1 ‚Äî DATOS DEL PACIENTE ===================== -->
<div id="modalPaciente" 
     class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg w-96 p-6 shadow-lg relative">
    <h2 class="text-xl font-semibold mb-4">Datos del Paciente</h2>

    <div class="space-y-2">
      <p><strong>Nombre:</strong> <span id="pacienteNombre"></span></p>
      <p><strong>Tipo de documento:</strong> <span id="pacienteTipo"></span></p>
      <p><strong>Documento:</strong> <span id="pacienteDocumento"></span></p>
      <p><strong>Ciudad de expedici√≥n:</strong> <span id="pacienteCiudad"></span></p>
    </div>

    <div class="flex justify-end mt-5 gap-3">
      <button onclick="cerrarModal('modalPaciente')" 
              class="px-3 py-1 border rounded text-gray-600 hover:bg-gray-100">
        Cerrar
      </button>
      <button onclick="abrirModalFirma()" 
              class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700">
        Firmar
      </button>
    </div>
  </div>
</div>

<!-- ===================== MODAL 2 ‚Äî FIRMA ===================== -->
<div id="modalFirma" 
     class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
  <div class="bg-white rounded-lg w-[500px] p-6 shadow-lg relative">
    <h2 class="text-xl font-semibold mb-4">Firma del Paciente</h2>

    <p class="text-gray-600 text-sm mb-3">Use una tableta o el mouse para firmar:</p>

    <canvas id="canvasFirma" 
            class="border w-full h-48 rounded mb-3"></canvas>

    <div class="flex justify-between items-center">
      <input type="file" id="firmaArchivo" accept="image/*" class="text-sm">
      <button onclick="limpiarFirma()" class="text-sm text-gray-600 hover:underline">Limpiar</button>
    </div>

    <div class="flex justify-end mt-5 gap-3">
      <button onclick="cerrarModal('modalFirma')" 
              class="px-3 py-1 border rounded text-gray-600 hover:bg-gray-100">
        Cancelar
      </button>
      <button onclick="guardarFirma()" 
              class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700">
        Guardar Firma
      </button>
    </div>
  </div>
</div>

<!-- ===================== SCRIPTS ===================== -->
<!-- <script>
function abrirModalPaciente(id, nombre, tipo, documento, ciudad) {
  document.getElementById("pacienteNombre").textContent = nombre;
  document.getElementById("pacienteTipo").textContent = tipo;
  document.getElementById("pacienteDocumento").textContent = documento;
  document.getElementById("pacienteCiudad").textContent = ciudad;
  document.getElementById("modalPaciente").classList.remove("hidden");
}

function abrirModalFirma() {
  document.getElementById("modalPaciente").classList.add("hidden");
  document.getElementById("modalFirma").classList.remove("hidden");
}

function cerrarModal(id) {
  document.getElementById(id).classList.add("hidden");
} -->

<!-- // Firma con Canvas
// let canvas = document.getElementById("canvasFirma");
// let ctx = canvas.getContext("2d");
// let firmando = false;

// canvas.addEventListener("mousedown", () => firmando = true);
// canvas.addEventListener("mouseup", () => firmando = false);
// canvas.addEventListener("mousemove", dibujar);

// function dibujar(e) {
//   if (!firmando) return;
//   ctx.lineWidth = 2;
//   ctx.lineCap = "round";
//   ctx.strokeStyle = "black";
//   ctx.lineTo(e.offsetX, e.offsetY);
//   ctx.stroke();
//   ctx.beginPath();
//   ctx.moveTo(e.offsetX, e.offsetY);
// }

// function limpiarFirma() {
//   ctx.clearRect(0, 0, canvas.width, canvas.height);
//   ctx.beginPath();
// }

// function guardarFirma() {
//   let firma = canvas.toDataURL("image/png");
//   console.log("Firma guardada en base64:", firma.substring(0, 50) + "...");
//   cerrarModal("modalFirma");
// }
// </script> -->
{% endblock %}
